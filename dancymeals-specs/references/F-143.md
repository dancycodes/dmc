# F-143 â€” Order Phone Number

> Module: Ordering
> Priority: Must-have
> Precedence: F-139
> Type: functional

---

## What It Does
Collects the phone number to be used for delivery communication during the ordering process. The phone number is pre-filled from the authenticated user's profile but can be overridden per order. If the client changes the phone number, it applies only to this order and does not update their profile. The phone number is validated to match the Cameroon format. This is a required field before proceeding to the order summary.

---

## Who Uses It
| Role | Interaction |
|------|-------------|
| Client (authenticated) | Confirms or changes their phone number for this order |

---

## User Scenarios
### Scenario 1: Using profile phone number
The client's profile has "+237 655 123 456" as their phone number. The field is pre-filled with this number. The client confirms it and proceeds.

### Scenario 2: Overriding phone number for this order
The client wants delivery to a friend's location. They change the phone number to "+237 677 987 654." The order uses this new number but the client's profile is not updated.

### Scenario 3: Invalid phone number
The client enters "123456" which is not a valid Cameroon number. A validation error appears: "Please enter a valid Cameroon phone number (+237 followed by 9 digits)."

### Scenario 4: Profile has no phone number
The client's profile phone field is empty (unlikely but possible). The field is blank and the client must enter a phone number to proceed.

---

## Business Rules
| Code | Rule |
|------|------|
| BR-292 | Phone number is pre-filled from the authenticated user's profile phone number |
| BR-293 | The client can override the phone number per order |
| BR-294 | Overriding the phone number does NOT update the user's profile |
| BR-295 | Phone number must match Cameroon format: +237 followed by 9 digits (starting with 6, 7, or 2) |
| BR-296 | Phone number is a required field |
| BR-297 | Validation error messages must be localized via `__()` |
| BR-298 | Phone number is stored with the order for delivery/communication purposes |

---

## Data Involved
**Reads:**
- User profile: phone number

**Creates:**
- Phone number in checkout session/order draft

**Updates:**
- Checkout session with the order phone number

**Relationships:**
- Part of the checkout flow after F-141 (Delivery Location) or F-142 (Pickup Location)
- Phone number stored in the order created during checkout finalization
- Precedes F-146 (Order Total Calculation & Summary)

---

## Acceptance Criteria
- **Given** a user with phone "+237 655 123 456" in their profile, **when** this step loads, **then** the field is pre-filled with that number
- **Given** the client changes the phone number, **when** proceeding, **then** the order uses the new number
- **Given** the client changed the phone number, **when** checking their profile, **then** the profile phone is unchanged
- **Given** an invalid phone number, **when** attempting to proceed, **then** a validation error is shown
- **Given** the phone field is empty, **when** attempting to proceed, **then** a required field error is shown

---

## Verification Steps
1. Proceed to the phone step and verify the profile phone number is pre-filled
2. Change the phone number and proceed; verify the order stores the new number
3. Check the user profile after order; verify it was not updated
4. Enter an invalid phone format and verify the validation error
5. Clear the field and try to proceed; verify the required field error

---

## Edge Cases & Exceptions
| Condition | Expected Behavior |
|-----------|-------------------|
| User profile has no phone number | Field is blank; required validation applies |
| Phone number with spaces or dashes | Normalized to digits only during validation |
| Client enters phone without +237 prefix | Auto-prepend +237 if they enter 9 digits starting with 6 |
| Phone number matches a non-mobile format | Reject with specific error; only mobile numbers accepted |

---

## UI/UX Notes
- Phone input with country code prefix (+237) shown as non-editable prefix
- Input masked or formatted for readability: +237 6XX XXX XXX
- Helper text: "This number will be used by the cook to contact you about your order"
- "Same as my profile" quick option if the user has changed it
- Step indicator showing progress
- "Back" and "Continue" buttons

---

## Related Features
| Code | Feature | Relationship |
|------|---------|-------------|
| F-141 | Delivery Location Selection | Previous step (for delivery orders) |
| F-142 | Pickup Location Selection | Previous step (for pickup orders) |
| F-146 | Order Total Calculation & Summary | Next step |
