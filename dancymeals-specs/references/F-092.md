# F-092 â€” Add Pickup Location

> Module: Location
> Priority: Must-have
> Precedence: F-076
> Type: functional

---

## What It Does

Allows a cook to add a pickup location where clients can collect their orders in person. The cook enters the location name (en/fr), selects a town and quarter (from their existing delivery areas), and provides a specific address or description. Pickup locations have no delivery fees. The location is saved via Gale and appears in the pickup locations list immediately.

---

## Who Uses It

| Role | Interaction |
|------|-------------|
| Cook | Adds pickup points for clients who prefer to collect orders |
| Manager | Adds pickup locations if granted location management permission |

---

## User Scenarios

### Scenario 1: Add a pickup location
A cook clicks "Add Pickup Location." They enter: name "My Kitchen" (en) / "Ma Cuisine" (fr), select town "Douala", select quarter "Akwa", enter address "Behind Akwa Palace Hotel, near the blue gate." They save. The location appears in the pickup list.

### Scenario 2: Pickup at multiple locations
A cook adds 3 pickup locations: their home kitchen, a market stall, and a partner restaurant. Each has a different address. Clients can choose any when placing orders.

### Scenario 3: No towns exist yet
A cook tries to add a pickup location but has not yet added any towns. The town dropdown is empty. A message says: "Add a town first before creating pickup locations."

---

## Business Rules

| Code | Rule |
|------|------|
| BR-281 | Location name is required in both English and French |
| BR-282 | Town selection is required (from cook's existing towns) |
| BR-283 | Quarter selection is required (from quarters within the selected town) |
| BR-284 | Address/description is required (free text, max 500 characters) |
| BR-285 | Pickup locations have no delivery fee (fee is always 0/N/A) |
| BR-286 | Pickup location is scoped to the current tenant |
| BR-287 | Save via Gale; location appears in list without page reload |
| BR-288 | Only users with location management permission can add pickup locations |

---

## Data Involved

**Creates:**
- Pickup location record: id, tenant_id, name_en, name_fr, town_id, quarter_id, address, created_at, updated_at

**Reads:**
- Existing towns for this tenant (for town dropdown)
- Quarters within selected town (for quarter dropdown)

**Updates:**
- Pickup locations list UI (via Gale)

---

## Acceptance Criteria

- **Given** the add pickup location form, **when** the cook fills all required fields and saves, **then** the location is created and appears in the list
- **Given** a missing location name (either language), **when** submitting, **then** a validation error is shown
- **Given** no town selected, **when** submitting, **then** a validation error requires town selection
- **Given** no address provided, **when** submitting, **then** a validation error is shown
- **Given** no towns exist, **when** opening the form, **then** a message directs the cook to add towns first
- **Given** a town is selected, **when** the quarter dropdown loads, **then** only quarters for that town are shown

---

## Verification Steps

1. Add a pickup location with all required fields and confirm it appears
2. Submit with missing French name and confirm validation error
3. Submit without selecting a town and confirm error
4. Submit without an address and confirm error
5. Change the selected town and verify quarter dropdown updates
6. Verify the location is stored with the correct tenant_id

---

## Edge Cases & Exceptions

| Condition | Expected Behavior |
|-----------|-------------------|
| Cook deletes the town after creating pickup location there | Pickup location should be cascade-deleted or marked invalid |
| Very long address (approaching 500 chars) | Character counter; blocked at limit |
| Cook has towns but no quarters | Quarter dropdown empty; message says to add quarters first |
| Multiple pickup locations in same quarter | Allowed; different addresses within the same area |

---

## UI/UX Notes

- Form fields: name (en), name (fr), town dropdown, quarter dropdown (cascading), address textarea
- Town and quarter dropdowns are cascading: selecting a town populates quarters
- Address field is a textarea with placeholder example: "Near [landmark], [street name]"
- Character counter on address field
- "Save" and "Cancel" buttons
- Pickup locations section separate from delivery areas in the Locations page
- Pin icon for pickup locations (distinct from truck icon for delivery)
- Breadcrumb: Dashboard > Locations > Add Pickup Location

---

## Related Features

| Code | Feature | Relationship |
|------|---------|-------------|
| F-076 | Cook Dashboard Layout | Parent dashboard |
| F-082 | Add Town | Towns must exist for pickup location assignment |
| F-093 | Pickup Location List View | Displays the added location |
| F-094 | Edit Pickup Location | Edit the location after creation |
| F-096 | Meal-Specific Location Override | Meals can override available pickup locations |
