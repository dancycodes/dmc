# F-080 â€” Cook Brand Profile Edit

> Module: Cook Profile
> Priority: Must-have
> Precedence: F-079
> Type: functional

---

## What It Does

Provides the edit form for the cook's brand profile. Allows editing brand name (en/fr), bio/description (en/fr), WhatsApp number, phone number, and social media links (Facebook, Instagram, TikTok). Form validation enforces bilingual requirements and phone format. Saves via Gale without page reload and shows a toast notification on success. All changes are logged via Spatie Activitylog.

---

## Who Uses It

| Role | Interaction |
|------|-------------|
| Cook | Edits their brand name, bio, contact details, and social links |
| Manager | Edits the profile if granted profile edit permission |

---

## User Scenarios

### Scenario 1: Edit brand name
A cook changes their brand name from "Chef Latifa's Kitchen" to "Latifa's Home Cooking" in both English and French. They click "Save." A toast notification confirms "Profile updated successfully." The changes reflect immediately.

### Scenario 2: Update WhatsApp number
A cook changes their WhatsApp number to a new number. The form validates the Cameroon phone format. After saving, the new number appears in the profile view.

### Scenario 3: Add social links
A cook had no social links. They paste their Instagram URL and TikTok URL. The URLs are validated as proper URLs. After saving, both links appear as icons in the profile view.

### Scenario 4: Validation error
A cook changes the English brand name but clears the French brand name. They click "Save." A validation error appears: "Brand name is required in both English and French."

### Scenario 5: Activity logging
A cook updates their bio. The change is logged in the activity log with: who changed it, what was changed (old and new values), and when.

---

## Business Rules

| Code | Rule |
|------|------|
| BR-187 | Brand name required in both English and French; max 100 characters each |
| BR-188 | If bio is provided in one language, it must be provided in both; max 1000 characters each |
| BR-189 | WhatsApp number is required; must be valid Cameroon format (+237) |
| BR-190 | Phone number is optional; must be valid Cameroon format if provided |
| BR-191 | Social links are optional; must be valid URLs if provided |
| BR-192 | All changes saved via Gale (no page reload) |
| BR-193 | Success feedback via toast notification |
| BR-194 | All profile changes must be logged via Spatie Activitylog (old and new values) |
| BR-195 | Only users with profile edit permission for this tenant can submit the form |
| BR-196 | All form labels and messages must use `__()` localization |

---

## Data Involved

**Reads:**
- Current cook profile data (for form pre-population)

**Updates:**
- Cook profile fields: name_en, name_fr, bio_en, bio_fr, whatsapp, phone, social_facebook, social_instagram, social_tiktok

**Creates:**
- Activity log entry recording the changes

---

## Acceptance Criteria

- **Given** the profile edit form, **when** the cook updates the brand name (en/fr) and saves, **then** the changes are persisted and a toast confirms success
- **Given** the English name is changed but French name is cleared, **when** saving, **then** a validation error appears for the French name
- **Given** a bio entered in English only, **when** saving, **then** a validation error requires the French bio
- **Given** an invalid WhatsApp number, **when** saving, **then** a phone format validation error appears
- **Given** an invalid social link URL, **when** saving, **then** a URL validation error appears
- **Given** a successful save, **when** checking the activity log, **then** the change is recorded with old and new values
- **Given** a manager without edit permission, **when** they access the edit form, **then** they receive a 403 response

---

## Verification Steps

1. Edit the brand name in both languages and confirm successful save with toast
2. Clear the French name and confirm validation error
3. Enter a bio in English only and confirm paired validation error
4. Change the WhatsApp number to an invalid format and confirm error
5. Enter an invalid social media URL and confirm error
6. Save a change and verify the activity log records it
7. Check that saved changes appear in the profile view (F-079)
8. Verify no page reload occurs during save

---

## Edge Cases & Exceptions

| Condition | Expected Behavior |
|-----------|-------------------|
| Network error during save | Toast error message; form data preserved for retry |
| Concurrent edits (cook and manager) | Last save wins; no conflict resolution needed |
| Special characters in name/bio (emojis, accents) | Accepted and stored correctly |
| WhatsApp number with formatting (spaces, dashes) | Normalized before validation and storage |
| Removing all social links | Allowed; social section shows empty in profile view |

---

## UI/UX Notes

- Form layout matches the Brand Info wizard step (F-072) for consistency
- Two-column for en/fr fields on desktop; stacked on mobile
- Character counters for bio fields
- Phone fields with +237 prefix indicator
- Social link fields with platform icons
- "Save" button with loading state during submission
- "Cancel" link to return to profile view without saving
- Inline validation errors next to relevant fields
- Breadcrumb: Dashboard > Profile > Edit

---

## Related Features

| Code | Feature | Relationship |
|------|---------|-------------|
| F-079 | Cook Brand Profile View | Navigates to this edit form; returns to view after save |
| F-072 | Brand Info Step | Wizard version of this same edit form |
| F-017 | Activity Logging Setup | Records profile changes |
