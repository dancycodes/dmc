# F-087 — Quarter List View

> Module: Location
> Priority: Must-have
> Precedence: F-086
> Type: functional

---

## What It Does

Displays a list of all quarters within a selected town. Each quarter entry shows the quarter name (in current locale), delivery fee (formatted in XAF), and group membership (if any). The list supports filtering by group. Each quarter has links to edit and delete. The list updates via Gale when quarters are added, edited, or removed.

---

## Who Uses It

| Role | Interaction |
|------|-------------|
| Cook | Views and manages quarters within a town |
| Manager | Views quarters if granted location view permission |

---

## User Scenarios

### Scenario 1: View quarter list
A cook clicks on "Douala" in the town list. The quarter list expands showing: "Bonaberi — 500 XAF", "Akwa — Free", "Deido — 300 XAF (Central Douala group)." Each quarter has Edit and Delete buttons.

### Scenario 2: Filter by group
A cook selects "Central Douala" from the group filter dropdown. Only quarters belonging to that group are shown. Selecting "All" resets the filter.

### Scenario 3: Empty quarter list
A newly added town has no quarters yet. The list shows: "No quarters added yet. Add your first quarter." with an "Add Quarter" button.

---

## Business Rules

| Code | Rule |
|------|------|
| BR-242 | Quarter list shows all quarters for the selected town |
| BR-243 | Each entry displays: quarter name (current locale), delivery fee (XAF), group name (if assigned) |
| BR-244 | Quarters are sorted alphabetically by name in the current locale |
| BR-245 | Filter by group is available if quarter groups exist for this tenant |
| BR-246 | Delivery fee of 0 is displayed as "Free delivery" |
| BR-247 | Quarters in a group show the group's fee (not their individual fee) with group name indicated |
| BR-248 | Empty state shown when no quarters exist for the town |
| BR-249 | List updates via Gale when quarters change |

---

## Data Involved

**Reads:**
- Quarters for the selected town (name_en, name_fr, delivery_fee, quarter_group_id)
- Quarter group names (for display and filter)
- User permissions (to show/hide edit/delete actions)

**Creates:**
- Nothing

**Updates:**
- Nothing (display only)

---

## Acceptance Criteria

- **Given** quarters exist for a town, **when** the cook views the town, **then** all quarters are listed with fees and group info
- **Given** a quarter with 0 XAF fee, **when** listed, **then** it shows "Free delivery"
- **Given** a quarter in a group, **when** listed, **then** it shows the group name and group fee
- **Given** no quarters, **when** viewing a town, **then** an empty state with "Add Quarter" is shown
- **Given** quarter groups exist, **when** the filter dropdown renders, **then** group options are available
- **Given** a group filter selected, **when** applied, **then** only quarters in that group are shown

---

## Verification Steps

1. View a town with quarters and confirm all are listed with correct data
2. Verify a 0 XAF quarter shows "Free delivery"
3. Verify grouped quarters show group name and fee
4. Filter by group and confirm only matching quarters appear
5. View an empty town and confirm the empty state message
6. Switch language and confirm quarter names update

---

## Edge Cases & Exceptions

| Condition | Expected Behavior |
|-----------|-------------------|
| Town with 50+ quarters | List is scrollable; performance acceptable |
| All quarters in the same group | Group filter shows one option plus "All" |
| Quarter group is deleted while viewing | Quarter reverts to individual fee display on next refresh |
| Quarter name identical in en and fr | Displayed correctly regardless |

---

## UI/UX Notes

- Displayed within the expanded town card or as a sub-page
- Compact list/table format: name, fee, group badge, action buttons
- Group filter dropdown at the top of the list
- Free delivery shown with green "Free" badge
- Group membership shown as a small colored tag/pill
- Edit (pencil) and Delete (trash) action buttons per row
- "Add Quarter" button at the top or bottom of the list
- Breadcrumb: Dashboard > Locations > [Town Name]

---

## Related Features

| Code | Feature | Relationship |
|------|---------|-------------|
| F-083 | Town List View | Parent view; town must be selected first |
| F-086 | Add Quarter | Adds quarters to this list |
| F-088 | Edit Quarter | Edit action from this list |
| F-089 | Delete Quarter | Delete action from this list |
| F-090 | Quarter Group Creation | Groups shown as filter and badge |
