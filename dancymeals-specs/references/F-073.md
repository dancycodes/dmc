# F-073 — Cover Images Step

> Module: Cook Onboarding
> Priority: Must-have
> Precedence: F-071
> Type: functional

---

## What It Does

Wizard Step 2. Allows the cook to upload up to 5 cover images for their brand. Images can be dragged to reorder. A preview carousel shows how images will appear on the cook's tenant landing page and discovery card. Accepts JPG, PNG, and WebP formats with a maximum file size of 2MB each. Images are resized/cropped for consistency. This step can be skipped since cover images are not required for minimum setup.

---

## Who Uses It

| Role | Interaction |
|------|-------------|
| Cook | Uploads, reorders, and previews cover images for their brand |
| Manager | May manage cover images if permitted |

---

## User Scenarios

### Scenario 1: Upload cover images
A cook clicks "Upload Images" and selects 3 photos from their device. Each image uploads with a progress indicator. After upload, thumbnails appear in a sortable grid. A carousel preview shows how the images will look.

### Scenario 2: Reorder images
A cook has uploaded 4 images. They drag the 3rd image to the 1st position. The order updates and the preview carousel reflects the new order. The first image is the primary/featured image.

### Scenario 3: Delete an image
A cook has 5 images and wants to remove one. They click the delete (X) button on the image thumbnail. A confirmation appears. After confirming, the image is removed and the remaining images reorder.

### Scenario 4: Skip this step
A cook clicks "Skip" to proceed to Step 3 without uploading images. The step is marked as skipped (not complete) in the progress bar. The cook can return to upload images later.

### Scenario 5: Invalid file upload
A cook attempts to upload a 5MB JPEG. The upload is rejected with an error: "Image must be under 2MB." A cook attempts to upload a PDF. The upload is rejected: "Only JPG, PNG, and WebP images are accepted."

### Scenario 6: Mobile upload
On mobile, the cook taps "Upload Images" and their device shows the camera/gallery picker. They select images. Upload progresses. Drag-to-reorder works via touch-and-hold.

---

## Business Rules

| Code | Rule |
|------|------|
| BR-127 | Maximum 5 cover images per cook |
| BR-128 | Accepted formats: JPEG (.jpg/.jpeg), PNG (.png), WebP (.webp) |
| BR-129 | Maximum file size: 2MB per image |
| BR-130 | Images are resized to a consistent aspect ratio (16:9 recommended) for carousel display |
| BR-131 | Image order determines carousel display order; first image is the primary/featured image |
| BR-132 | This step is optional — not required for minimum setup (can be skipped) |
| BR-133 | Drag-to-reorder must work on both desktop (mouse drag) and mobile (touch drag) |
| BR-134 | Uploaded images are stored via the configured image handling package (Intervention Image or Spatie Media Library) |
| BR-135 | Deleting an image requires confirmation before removal |

---

## Data Involved

**Creates:**
- Image records associated with the cook's tenant
- Physical image files (stored in configured disk)

**Reads:**
- Existing cover images (for pre-population on revisit)

**Updates:**
- Image order/position when reordered
- Image records when deleted

---

## Acceptance Criteria

- **Given** Step 2 of the wizard, **when** the cook uploads a valid image, **then** it appears as a thumbnail with a progress indicator and is added to the preview carousel
- **Given** 5 images uploaded, **when** the cook tries to upload another, **then** the upload is blocked with a "Maximum 5 images" message
- **Given** uploaded images, **when** the cook drags an image to a new position, **then** the order updates and the carousel reflects the new order
- **Given** an uploaded image, **when** the cook clicks delete and confirms, **then** the image is removed
- **Given** a file over 2MB, **when** the cook attempts to upload, **then** a validation error is shown
- **Given** a non-image file (e.g., PDF), **when** the cook attempts to upload, **then** a format error is shown
- **Given** no images uploaded, **when** the cook clicks "Skip", **then** they proceed to Step 3

---

## Verification Steps

1. Upload a valid JPG under 2MB and confirm it appears in the thumbnail grid and preview carousel
2. Upload a PNG and a WebP file and confirm both are accepted
3. Attempt to upload a 5MB file and confirm the size error
4. Attempt to upload a PDF and confirm the format error
5. Upload 5 images, then try to upload a 6th — confirm the limit error
6. Drag an image to reorder and confirm the carousel updates
7. Delete an image and confirm it is removed with remaining images reordered
8. Click "Skip" without uploading and confirm advancement to Step 3

---

## Edge Cases & Exceptions

| Condition | Expected Behavior |
|-----------|-------------------|
| Network interruption during upload | Upload fails gracefully with error message; retry option shown |
| Very large image dimensions (e.g., 8000x6000) | Server-side resize handles it; upload may take longer |
| Corrupt image file | Upload fails with "Unable to process image" error |
| Cook uploads same image twice | Allowed (no duplicate detection by content) |
| Browser does not support drag-and-drop | Fallback: up/down arrow buttons for reordering |

---

## UI/UX Notes

- Upload area: dashed border drop zone with "Click or drag images here" prompt
- Thumbnails in a sortable grid (2 columns on mobile, 3 on desktop)
- Each thumbnail has a delete (X) button in the corner
- Progress bar overlay on each image during upload
- Preview carousel below the thumbnails showing how images will appear to clients
- Counter showing "3/5 images uploaded"
- Mobile: camera icon + gallery icon for image source selection
- Loading states during upload and reorder operations

---

## Related Features

| Code | Feature | Relationship |
|------|---------|-------------|
| F-071 | Cook Setup Wizard Shell | Parent wizard containing this step |
| F-072 | Brand Info Step | Previous step in the wizard |
| F-074 | Delivery Areas Step | Next step in the wizard |
| F-081 | Cook Cover Images Management | Full version of this feature in the dashboard |
| F-067 | Cook Card Component | Displays cover images on the discovery page |
