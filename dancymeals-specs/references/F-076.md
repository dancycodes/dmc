# F-076 — Cook Dashboard Layout & Navigation

> Module: Cook Dashboard
> Priority: Must-have
> Precedence: F-004, F-006, F-016
> Type: functional

---

## What It Does

Provides the dashboard layout and sidebar navigation for a cook's tenant domain. This is the primary workspace where cooks manage their business. Only accessible to users with the cook or manager role for the current tenant. The sidebar contains navigation links to all cook management sections: Home, Meals, Orders, Locations, Schedule, Profile, Managers, Settings, Analytics, Wallet, Complaints, and Testimonials. The layout is fully responsive with tenant branding and supports light/dark mode.

---

## Who Uses It

| Role | Interaction |
|------|-------------|
| Cook | Accesses all dashboard sections to manage their food business |
| Manager | Accesses permitted dashboard sections based on their granted permissions |
| Client | Blocked — cannot access dashboard routes |
| Guest | Redirected to login |

---

## User Scenarios

### Scenario 1: Cook accesses dashboard
A cook navigates to their tenant domain's dashboard (e.g., `latifa.dm.test/dashboard`). The layout loads with a sidebar showing all 12 navigation sections. The cook's brand name appears at the top of the sidebar.

### Scenario 2: Manager with limited permissions
A manager assigned to Latifa's tenant logs in and visits the dashboard. The sidebar only shows sections they have permission to access (e.g., Orders and Meals, but not Wallet or Settings). Hidden sections are not rendered at all.

### Scenario 3: Mobile navigation
On mobile, the sidebar is collapsed. A hamburger menu in the header opens the sidebar as a slide-over overlay. Tapping a section navigates to it and closes the sidebar.

### Scenario 4: Client attempts dashboard access
A client user visits `latifa.dm.test/dashboard`. They receive a 403 Forbidden response since they lack the cook/manager role for this tenant.

### Scenario 5: Cross-tenant access attempt
A cook for tenant "latifa" visits `moussa.dm.test/dashboard`. They receive a 403 because they are not a cook/manager for the "moussa" tenant.

### Scenario 6: Setup incomplete
A cook whose tenant has `setup_complete = false` visits the dashboard. A prominent banner shows: "Complete your setup to go live" with a link to the setup wizard (F-071). The dashboard is still functional but the banner persists.

---

## Business Rules

| Code | Rule |
|------|------|
| BR-156 | Dashboard routes are only accessible on tenant domains (not the main domain) |
| BR-157 | Only users with cook or manager role for the current tenant can access the dashboard |
| BR-158 | Sidebar navigation sections are permission-based — only sections the user has permission to view are rendered |
| BR-159 | The sidebar displays all 12 sections: Home, Meals, Orders, Locations, Schedule, Profile, Managers, Settings, Analytics, Wallet, Complaints, Testimonials |
| BR-160 | The layout must display tenant branding (brand name, theme) |
| BR-161 | The layout must support light and dark mode |
| BR-162 | The layout must be fully responsive (mobile-first) |
| BR-163 | If tenant setup is incomplete, a setup completion banner is shown at the top of every dashboard page |
| BR-164 | All user-facing text must use `__()` localization |

---

## Data Involved

**Reads:**
- Current tenant (from tenant resolution middleware)
- Authenticated user's roles and permissions for this tenant
- Tenant setup status (`setup_complete`)
- Tenant branding settings (name, theme)

**Creates:**
- Nothing (layout feature)

**Updates:**
- Nothing (layout feature)

---

## Acceptance Criteria

- **Given** a cook on their tenant domain, **when** they visit `/dashboard`, **then** the dashboard layout loads with all 12 sidebar sections
- **Given** a manager with limited permissions, **when** they visit the dashboard, **then** only permitted sidebar sections are visible
- **Given** a client user, **when** they visit `/dashboard` on a tenant domain, **then** they receive a 403 response
- **Given** a cook for a different tenant, **when** they visit this tenant's dashboard, **then** they receive a 403 response
- **Given** a guest, **when** they visit `/dashboard`, **then** they are redirected to the login page
- **Given** an incomplete setup, **when** the cook views any dashboard page, **then** a setup completion banner is shown
- **Given** a mobile viewport, **when** the dashboard loads, **then** the sidebar is collapsed behind a hamburger menu

---

## Verification Steps

1. Log in as a cook and visit the dashboard — confirm all 12 sidebar sections
2. Log in as a manager with limited permissions — confirm only permitted sections show
3. Log in as a client and visit the dashboard — confirm 403 response
4. Verify the tenant's brand name appears in the sidebar header
5. Toggle dark mode — confirm the layout renders correctly
6. Test on mobile — confirm hamburger menu and slide-over sidebar
7. Set tenant `setup_complete = false` — confirm the setup banner appears
8. Switch language to French — confirm all navigation labels are translated

---

## Edge Cases & Exceptions

| Condition | Expected Behavior |
|-----------|-------------------|
| User is both cook on tenant A and client on tenant B | Dashboard only accessible on tenant A's domain |
| Tenant is deactivated while cook is logged in | Next request shows "site unavailable" page |
| User's permissions change mid-session | Next page load re-evaluates permissions; sidebar updates |
| Browser back button after logout | Redirected to login; no cached dashboard content |
| Very long brand name | Truncated in sidebar with ellipsis |

---

## UI/UX Notes

- Sidebar width: ~260px on desktop, full slide-over on mobile
- Sidebar sections grouped logically:
  - Overview: Home
  - Business: Meals, Orders
  - Coverage: Locations, Schedule
  - Brand: Profile, Managers
  - Insights: Analytics, Wallet
  - Engagement: Complaints, Testimonials
  - System: Settings
- Active navigation item highlighted with accent color and left border indicator
- Brand name and small logo/avatar at the top of the sidebar
- Quick toggle for light/dark mode in sidebar footer
- Language switcher in sidebar footer
- Main content area has breadcrumb navigation
- Content loads via Gale navigation (no full page reloads)

---

## Related Features

| Code | Feature | Relationship |
|------|---------|-------------|
| F-004 | Multi-Tenant Domain Resolution | Resolves which tenant's dashboard to show |
| F-006 | Role & Permission Seed Setup | Provides RBAC for dashboard access control |
| F-016 | Base Layout & Responsive Navigation | Base layout this dashboard extends |
| F-071 | Cook Setup Wizard Shell | Wizard shown when setup incomplete |
| F-077 | Cook Dashboard Home | Home/default section of the dashboard |
