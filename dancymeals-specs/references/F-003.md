# F-003 â€” Core Package Installation

> Module: Foundation
> Priority: Must-have
> Precedence: F-002
> Type: foundation

---

## What It Does
Installs all required third-party packages for DancyMeals via Composer and npm. Publishes configuration files for each package. Verifies every package is properly installed, configured, and ready for use by subsequent features. This is the single point where all external dependencies are added to the project.

---

## Who Uses It
| Role | Interaction |
|------|-------------|
| Developer | Installs packages, publishes configs, verifies installation |

---

## User Scenarios
### Scenario 1: Full package installation
The developer installs all required Composer packages (spatie/laravel-permission, spatie/laravel-activitylog, spatie/laravel-honeypot, flutterwavedev/flutterwave-v3, laravel-notification-channels/webpush, intervention/image or spatie/laravel-medialibrary). Each package installs without conflicts, and config files are published.

### Scenario 2: Config publication and verification
After installation, the developer publishes all vendor configs and migrations. Each package's config file appears in `config/` and each package's migrations are available.

### Scenario 3: Version conflict resolution
A package version conflicts with Laravel 12 or another dependency. Composer displays the conflict, and the developer resolves it by adjusting version constraints or finding a compatible alternative.

---

## Business Rules
| Code | Rule |
|------|------|
| BR-013 | All packages listed in the tech stack are mandatory; no substitutions without approval |
| BR-014 | Package configs must be published to `config/` so they can be version-controlled |
| BR-015 | Package migrations must be published so they can be customized if needed |
| BR-016 | All packages must be compatible with Laravel 12 and PHP 8.4 |
| BR-017 | No additional packages may be installed beyond the approved list without explicit approval |
| BR-018 | npm packages (Tailwind CSS v4, Alpine.js) must also be installed and configured |

---

## Data Involved
**Creates:**
- Config files: `permission.php`, `activitylog.php`, `honeypot.php`, `flutterwave.php`, `webpush.php`, image library config
- Published migration files for Spatie packages
- npm `package.json` dependencies for Tailwind CSS v4 and Alpine.js

**Reads:**
- `composer.json` for dependency resolution
- `package.json` for npm dependencies

**Updates:**
- `composer.json` and `composer.lock`
- `package.json` and `package-lock.json`
- `config/` directory with new config files

**Relationships:**
- Every subsequent feature depends on one or more packages installed here

---

## Acceptance Criteria
- **Given** a clean Laravel 12 project with database configured, **when** all packages are installed via Composer, **then** `composer install` completes without errors
- **Given** installed packages, **when** running `php artisan vendor:publish`, **then** each package's config and migrations are published
- **Given** published Spatie permission migrations, **when** running `php artisan migrate`, **then** the permission tables are created
- **Given** Tailwind CSS v4 is installed, **when** running `npm run build`, **then** CSS compiles without errors
- **Given** Alpine.js is installed, **when** inspecting the compiled JS, **then** Alpine is bundled and available

---

## Verification Steps
1. Run `composer show spatie/laravel-permission` and confirm it is installed
2. Run `composer show spatie/laravel-activitylog` and confirm it is installed
3. Run `composer show spatie/laravel-honeypot` and confirm it is installed
4. Run `composer show flutterwavedev/flutterwave-v3` and confirm it is installed
5. Run `composer show laravel-notification-channels/webpush` and confirm it is installed
6. Confirm image handling package is installed (intervention/image or spatie/laravel-medialibrary)
7. Run `php artisan migrate` and confirm Spatie tables are created (roles, permissions, activity_log, etc.)

---

## Edge Cases & Exceptions
| Condition | Expected Behavior |
|-----------|-------------------|
| Package version incompatible with Laravel 12 | Composer reports conflict; developer checks for compatible version |
| Network failure during install | Composer retries or fails gracefully; developer retries |
| Config already published (re-publish) | Artisan asks to overwrite; developer chooses to overwrite or skip |
| npm install fails | Developer checks Node.js version compatibility and retries |

---

## UI/UX Notes
No user-facing UI. This is a developer-only infrastructure feature. Tailwind CSS v4 and Alpine.js setup here will be used by all future UI features.

---

## Related Features
| Code | Feature | Relationship |
|------|---------|-------------|
| F-002 | Database Configuration | Prerequisite; packages need database to run migrations |
| F-004 | Multi-Tenant Domain Resolution | Uses this feature's installed packages |
| F-006 | Role & Permission Seed Setup | Uses spatie/laravel-permission installed here |
| F-009 | Theme System | Uses Tailwind CSS v4 installed here |
| F-012 | PWA Configuration | Uses webpush package installed here |
| F-017 | Activity Logging Setup | Uses spatie/laravel-activitylog installed here |
| F-018 | Honeypot Protection Setup | Uses spatie/laravel-honeypot installed here |
