# F-130 â€” Ratings Summary Display

> Module: Tenant Landing
> Priority: Should-have
> Precedence: F-126, F-176
> Type: functional

---

## What It Does
Renders a ratings summary section on the cook's tenant landing page. Displays the cook's overall average rating as stars with a numeric value, total review count, a star distribution bar chart (showing counts for 5-star through 1-star ratings), and the 5 most recent reviews. Includes a link to view all reviews if more than 5 exist.

---

## Who Uses It
| Role | Interaction |
|------|-------------|
| Client (guest or authenticated) | Views the cook's ratings and recent reviews to assess quality |
| Cook | Sees how their ratings section appears to potential clients |

---

## User Scenarios
### Scenario 1: Cook with many reviews
A visitor sees the ratings section showing: large "4.7" with filled star icons, "128 reviews" below. A horizontal bar chart shows: 5-star (85), 4-star (25), 3-star (10), 2-star (5), 1-star (3). Below, the 5 most recent reviews display with reviewer name, date, star count, and comment text. A "See all reviews" link is visible at the bottom.

### Scenario 2: Cook with few reviews
A cook has only 3 reviews. All 3 are displayed without a "See all reviews" link. The star distribution chart shows the 3 ratings distributed across the bars.

### Scenario 3: Cook with no reviews
The ratings section shows an empty state: "No reviews yet. Be the first to order and leave a review!" No stars, no distribution chart.

### Scenario 4: Viewing a review detail
Each review card shows the reviewer's first name (last name initial), the date of the review, the star rating given, and the review text (truncated to 3 lines with "Read more" toggle for longer reviews).

---

## Business Rules
| Code | Rule |
|------|------|
| BR-167 | Overall rating is the arithmetic average of all review scores, rounded to 1 decimal place |
| BR-168 | Star distribution chart shows the count of reviews per star level (1 through 5) |
| BR-169 | Recent reviews display the 5 most recent reviews sorted by creation date descending |
| BR-170 | Each review shows: reviewer first name + last initial, date, star rating, review text |
| BR-171 | Review text is truncated to 3 lines with a "Read more" toggle for longer content |
| BR-172 | "See all reviews" link appears only when more than 5 reviews exist |
| BR-173 | Cooks with zero reviews show an empty state message |
| BR-174 | All text in this section must be localized via `__()` |
| BR-175 | Reviewer identity is partially anonymized: first name + last name initial only |

---

## Data Involved
**Reads:**
- Reviews/ratings for the tenant: score, text, reviewer name, created_at
- Aggregate: average score, total count, per-star-level counts

**Creates:**
- Ratings summary Blade component
- Star distribution bar chart component
- Review card component

**Updates:**
- Nothing

**Relationships:**
- Child of F-126 (Tenant Landing Page Layout)
- Uses rating data from F-176 (Rating System)
- "See all reviews" links to F-177 or dedicated reviews page

---

## Acceptance Criteria
- **Given** a cook with an average rating of 4.7 and 128 reviews, **when** the section loads, **then** "4.7" with star icons and "128 reviews" is displayed
- **Given** review scores distributed across all star levels, **when** the section loads, **then** the bar chart shows correct counts per level
- **Given** 10 reviews exist, **when** the section loads, **then** the 5 most recent are shown with a "See all reviews" link
- **Given** 3 reviews exist, **when** the section loads, **then** all 3 are shown without a "See all reviews" link
- **Given** zero reviews, **when** the section loads, **then** the empty state message is displayed
- **Given** a review with a long text, **when** viewing the review card, **then** text is truncated with a "Read more" toggle

---

## Verification Steps
1. Visit a tenant site and scroll to the ratings section
2. Verify the average rating and review count display correctly
3. Verify the star distribution bar chart matches the actual review data
4. Verify the 5 most recent reviews are displayed in order
5. Click "Read more" on a long review and confirm full text appears
6. Click "See all reviews" and confirm navigation to the full reviews page
7. View a cook with no reviews and confirm the empty state

---

## Edge Cases & Exceptions
| Condition | Expected Behavior |
|-----------|-------------------|
| Average rating is exactly 5.0 | All stars filled, displays "5.0" |
| Average rating is exactly 1.0 | One star filled, displays "1.0" |
| Review text is empty (rating only) | Review card shows stars and date but no text area |
| Reviewer account has been deleted | Show "Anonymous" as the reviewer name |
| Hundreds of reviews | Only 5 shown; "See all reviews" links to paginated view |

---

## UI/UX Notes
- Section header: "Ratings & Reviews" (localized)
- Large average rating number with star icons beside it
- Bar chart bars use tenant theme accent color; unfilled portion in muted gray
- Review cards have subtle borders and consistent spacing
- Reviewer name in bold, date in muted text, stars as small filled/unfilled icons
- "Read more" / "Read less" toggle with smooth height transition
- Section anchored with id="ratings" for navigation

---

## Related Features
| Code | Feature | Relationship |
|------|---------|-------------|
| F-126 | Tenant Landing Page Layout | Parent layout containing this section |
| F-176 | Rating System | Source of rating and review data |
| F-177 | All Reviews Page | Destination of "See all reviews" link |
