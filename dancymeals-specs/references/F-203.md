# F-203 â€” Cook Delivery Performance Analytics

> Module: Analytics
> Priority: Could-have
> Precedence: F-200
> Type: functional

---

## What It Does
Provides delivery-focused insights for cooks within the analytics section. Shows metrics for orders by delivery area (town/quarter), delivery vs pickup ratio, and most popular delivery areas. Helps cooks understand geographic demand, optimize their delivery coverage, and decide whether to expand or contract their delivery zones.

---

## Who Uses It
| Role | Interaction |
|------|-------------|
| Cook | Views delivery performance analytics in the cook dashboard |
| Manager | Views if granted `view-analytics` permission |

---

## User Scenarios
### Scenario 1: Delivery vs pickup ratio
The cook sees a donut chart: "Delivery: 68%, Pickup: 32%." This tells them most customers prefer delivery.

### Scenario 2: Orders by delivery area
A bar chart shows orders grouped by town/quarter. "Douala - Bonamoussadi: 145 orders," "Douala - Akwa: 98 orders," "Douala - Makepe: 76 orders." The cook sees where most of their demand is.

### Scenario 3: Most popular delivery areas
A ranked list or map visualization shows the top delivery destinations. The cook notices a quarter they do not currently serve has demand from nearby areas.

### Scenario 4: Date range filtering
The cook selects "Last 3 Months" and the delivery area breakdown updates. They notice seasonal patterns in certain neighborhoods.

---

## Business Rules
| Code | Rule |
|------|------|
| BR-401 | Delivery data is tenant-scoped |
| BR-402 | Only completed/delivered orders with delivery addresses are included |
| BR-403 | Delivery area is derived from the order's delivery address (town/quarter) |
| BR-404 | Pickup orders are counted separately for the delivery vs pickup ratio |
| BR-405 | Top delivery areas shows the top 10 locations by order count |
| BR-406 | Date range selector applies to all charts and metrics |
| BR-407 | All user-facing text must use `__()` localization |

---

## Data Involved
**Reads:**
- `orders` table filtered by `tenant_id`, status, and delivery type
- Delivery address data (town, quarter) from orders
- Aggregated counts per area

**Creates:**
- Nothing

**Updates:**
- Nothing

---

## Acceptance Criteria
- **Given** a cook with delivery orders, **when** viewing delivery analytics, **then** delivery vs pickup ratio is shown
- **Given** delivery orders with addresses, **when** viewed, **then** orders are grouped by area
- **Given** a date range change, **when** applied, **then** charts update
- **Given** no delivery orders, **when** viewed, **then** empty state shown

---

## Verification Steps
1. Verify delivery vs pickup ratio is accurate
2. Verify orders-by-area chart shows correct counts per town/quarter
3. Verify top delivery areas ranking is correct
4. Change date range and verify updates
5. Test with pickup-only orders; verify delivery area charts show empty

---

## Edge Cases & Exceptions
| Condition | Expected Behavior |
|-----------|-------------------|
| All orders are pickup | Delivery area charts are empty; ratio shows 100% pickup |
| Delivery address has no quarter/town data | Grouped as "Unknown Area" |
| Cook serves only one area | One bar in the chart |
| Very many delivery areas (50+) | Top 10 shown; rest grouped as "Other Areas" |

---

## UI/UX Notes
- Sub-section within Analytics or a "Delivery" tab
- Delivery vs pickup as a donut chart
- Orders by area as a horizontal bar chart
- Summary card: "Total Deliveries: X, Most Popular Area: Y"
- Responsive layout; charts stack on mobile
- All interactions via Gale

---

## Related Features
| Code | Feature | Relationship |
|------|---------|-------------|
| F-200 | Cook Revenue Analytics | Prerequisite analytics infrastructure |
| F-208 | Analytics CSV/PDF Export | Export delivery data |
