# F-062 — Commission Configuration per Cook

> Module: Admin
> Priority: Must-have
> Precedence: F-047
> Type: functional

---

## What It Does
Allows admins to configure the platform commission percentage for a specific cook's tenant. The default commission is 10%. Admins can override this for any tenant, setting a rate between 0% and 50%. The configuration is accessible from the tenant detail page. The page shows the current rate and a history of all commission changes. New rates take effect immediately on new orders; existing orders retain the rate that was active when they were placed.

---

## Who Uses It
| Role | Interaction |
|------|-------------|
| Super-Admin | Sets and adjusts commission rates for any tenant |
| Admin | Sets and adjusts commission rates for any tenant |

---

## User Scenarios
### Scenario 1: Viewing current commission rate
An admin navigates to a tenant's detail page and clicks "Configure Commission." The page shows the current rate (10%) and notes that this is the platform default.

### Scenario 2: Setting a custom commission rate
The admin changes the rate from 10% to 8% for a high-volume cook as an incentive. They submit with a note: "Reduced rate for top performer." The new rate saves and appears in the change history.

### Scenario 3: Viewing commission history
The page shows a timeline of changes: "10% (Platform default) — Since tenant creation", then "8% — Set by Admin John on Feb 10, 2026 — Reason: Reduced rate for top performer."

### Scenario 4: Resetting to default
The admin clicks "Reset to Default" which sets the commission back to the platform default (10%). This is recorded in the history as a change.

### Scenario 5: Effect on new vs. existing orders
After changing the rate from 10% to 8%, the admin places a test order. The new order uses 8% commission. An existing order placed yesterday still uses 10%.

---

## Business Rules
| Code | Rule |
|------|------|
| BR-175 | Default commission rate is 10% |
| BR-176 | Commission range: 0% to 50% (inclusive), in 0.5% increments |
| BR-177 | New commission rate applies only to orders placed after the change |
| BR-178 | Existing orders retain the commission rate from when they were placed |
| BR-179 | Commission changes are recorded with: new rate, admin who changed it, timestamp, and optional reason |
| BR-180 | "Reset to Default" sets the rate back to the platform default (currently 10%) |
| BR-181 | Commission configuration is logged in the activity log |
| BR-182 | The Flutterwave subaccount split percentage must be updated to match the new commission rate |

---

## Data Involved
**Reads:**
- Tenant's current commission rate
- Commission change history for this tenant
- Platform default commission rate (from settings)

**Creates:**
- Commission change record: tenant_id, old_rate, new_rate, changed_by, reason, changed_at
- Activity log entry

**Updates:**
- Tenant or commission configuration: current commission rate
- Flutterwave subaccount: split percentage (if applicable)

**Relationships:**
- F-047: Accessible from tenant detail page
- F-057: Commission rates affect analytics calculations
- F-058: Commission rates used in financial reports

---

## Acceptance Criteria
- **Given** a tenant with default commission, **when** viewing the commission page, **then** the current rate shows as 10% (default)
- **Given** a new rate of 8%, **when** submitted, **then** the rate is updated and the change appears in history
- **Given** a changed rate, **when** a new order is placed, **then** it uses the new rate
- **Given** an existing order before the rate change, **when** viewed, **then** it retains the old rate
- **Given** the "Reset to Default" action, **when** clicked, **then** the rate reverts to the platform default
- **Given** a rate change, **when** checking the history, **then** the admin, timestamp, and reason are recorded

---

## Verification Steps
1. View commission page for a tenant — confirm current rate is displayed
2. Change rate to 8% — confirm it saves and history updates
3. Place an order after rate change — confirm new rate applies to the order's commission
4. Check an order placed before rate change — confirm old rate is retained
5. Reset to default — confirm rate reverts and history records the reset
6. Check activity log — confirm commission change is logged

---

## Edge Cases & Exceptions
| Condition | Expected Behavior |
|-----------|-------------------|
| Commission set to 0% | Cook receives 100% of order amount; platform earns nothing |
| Commission set to 50% | Platform takes half; cook receives half |
| Rate changed multiple times in same day | Each change recorded separately in history |
| Flutterwave subaccount update fails | Commission rate saved locally; admin warned to manually update Flutterwave |
| Admin enters a rate outside 0-50% | Validation error: "Commission must be between 0% and 50%" |
| Decimal rate like 7.5% | Allowed; stored as decimal |

---

## UI/UX Notes
- Current rate displayed prominently at the top with large text: "Current Commission: 8%"
- Rate input: slider with 0.5% increments and manual text input, both synchronized
- "Platform Default: 10%" shown as reference text
- "Reset to Default" button available when rate differs from default
- Reason field: optional textarea for documenting why the rate changed
- Change history: timeline below the form, most recent first
- Each history entry shows: old rate, new rate, admin name, date, reason
- Breadcrumb: Admin > Tenants > Chef Amara's Kitchen > Commission

---

## Related Features
| Code | Feature | Relationship |
|------|---------|-------------|
| F-047 | Tenant Detail View | Navigation source |
| F-057 | Platform Analytics | Commission data flows into analytics |
| F-058 | Financial Reports | Commission rates affect financial reports |
| F-063 | Platform Settings | Platform default commission defined in settings |
