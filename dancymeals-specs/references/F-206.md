# F-206 â€” Admin Cook Performance Metrics

> Module: Analytics
> Priority: Should-have
> Precedence: F-057
> Type: functional

---

## What It Does
Provides a cook comparison table in the admin panel allowing admins to evaluate and compare cook performance across the platform. The table includes columns for cook name, total orders, total revenue, average rating, complaint count, and average response time. Admins can sort by any column, filter by cook status or region, and identify top performers as well as at-risk cooks who may need support or intervention.

---

## Who Uses It
| Role | Interaction |
|------|-------------|
| Admin | Views and sorts the cook performance table |
| Super Admin | Full access |

---

## User Scenarios
### Scenario 1: View performance table
The admin navigates to Cook Performance in the admin panel. A table shows all active cooks with their metrics. Default sort is by total revenue descending.

### Scenario 2: Sort by complaint count
The admin clicks the "Complaints" column header. Cooks with the most complaints appear at the top. The admin identifies a cook with 15 complaints who may need attention.

### Scenario 3: Filter by region
The admin selects "Douala" from the region filter. The table shows only cooks based in Douala.

### Scenario 4: Identify at-risk cooks
The admin sorts by average rating (ascending). Cooks with the lowest ratings appear first. A cook with a 2.1 rating and 8 complaints is flagged for review.

### Scenario 5: Filter by status
The admin filters to see only inactive cooks. They can review why these cooks are inactive and whether to take action.

---

## Business Rules
| Code | Rule |
|------|------|
| BR-428 | Only admin and super-admin roles can access this page |
| BR-429 | Table columns: Cook Name, Region/Town, Total Orders, Total Revenue (XAF), Average Rating (stars), Complaint Count, Average Response Time |
| BR-430 | All columns are sortable (ascending/descending toggle) |
| BR-431 | Filters: cook status (active/inactive), region/town |
| BR-432 | Search by cook name |
| BR-433 | Average rating from review system (rounded to 1 decimal) |
| BR-434 | Complaint count includes all complaint statuses |
| BR-435 | Average response time = average time between complaint filed and cook's first response |
| BR-436 | Table is paginated (25 per page) |
| BR-437 | Date range selector applies to orders, revenue, and complaints counted |
| BR-438 | All amounts in XAF format |
| BR-439 | All user-facing text must use `__()` localization |

---

## Data Involved
**Reads:**
- `tenants` table for all cooks
- `users` table for cook names and status
- `orders` table aggregated by tenant for order count and revenue
- `reviews` table aggregated by tenant for average rating
- `complaints` table aggregated by tenant for complaint count
- `complaint_responses` table for response time calculation
- Tenant location data for region

**Creates:**
- Nothing

**Updates:**
- Nothing

---

## Acceptance Criteria
- **Given** an admin, **when** viewing cook performance, **then** a table with all cooks and their metrics is displayed
- **Given** the table, **when** the admin clicks a column header, **then** the table sorts by that column
- **Given** the region filter, **when** "Douala" is selected, **then** only Douala-based cooks are shown
- **Given** the search, **when** a cook name is entered, **then** matching cooks are displayed
- **Given** a non-admin user, **when** accessing this page, **then** they receive a 403 response

---

## Verification Steps
1. Verify all active cooks appear in the table with correct metrics
2. Sort by each column and verify correct ordering
3. Filter by region and verify results
4. Filter by status and verify results
5. Search by cook name and verify results
6. Verify complaint count matches actual complaints
7. Verify average response time is calculated correctly
8. Verify pagination with many cooks

---

## Edge Cases & Exceptions
| Condition | Expected Behavior |
|-----------|-------------------|
| Cook with no orders | Shows 0 orders, 0 XAF revenue, N/A rating |
| Cook with no complaints | Shows 0 complaints, N/A response time |
| Cook with no reviews | Average rating shows "N/A" or "No reviews" |
| Cook with complaints but no responses | Average response time shows "No response" or infinity |
| Hundreds of cooks | Pagination handles it; sorting/filtering remain performant |

---

## UI/UX Notes
- Table with sortable column headers (sort arrow indicators)
- Filter bar above the table: status dropdown, region dropdown, search input
- Clickable cook name links to the cook's detail in the admin panel
- Color coding on metrics: green for good (high rating, low complaints), red for concerning
- Responsive: horizontal scroll on mobile for the wide table
- Export button (links to F-208) for the filtered data
- All interactions via Gale

---

## Related Features
| Code | Feature | Relationship |
|------|---------|-------------|
| F-057 | Admin Dashboard | Admin panel shell |
| F-205 | Admin Platform Revenue Analytics | Sibling admin analytics |
| F-207 | Admin Growth Metrics | Sibling admin analytics |
| F-208 | Analytics CSV/PDF Export | Export this data |
