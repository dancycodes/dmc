# F-053 — Role List View

> Module: Admin
> Priority: Must-have
> Precedence: F-052
> Type: functional

---

## What It Does
Displays a list of all roles in the admin panel, showing each role's name, permission count, user count, and whether it is a system role or custom role. System roles (super-admin, admin, cook, manager, client) are clearly marked and protected from deletion. Admins can filter by system vs. custom roles and click any role to view or edit it.

---

## Who Uses It
| Role | Interaction |
|------|-------------|
| Super-Admin | Views all roles, manages custom roles |
| Admin | Views all roles, manages custom roles they have permission for |

---

## User Scenarios
### Scenario 1: Viewing all roles
An admin navigates to Roles in the sidebar. A list/table displays all roles: super-admin (5 users, 42 permissions, System), admin (3 users, 35 permissions, System), cook (28 users, 18 permissions, System), client (150 users, 8 permissions, System), "Kitchen Assistant" (4 users, 12 permissions, Custom).

### Scenario 2: Filtering by type
The admin clicks the "Custom" filter tab. Only custom roles are displayed. Switching to "System" shows only built-in roles. "All" shows everything.

### Scenario 3: Clicking a role
The admin clicks "Kitchen Assistant". They are navigated to the role edit/detail page (F-054) where they can see permissions and modify the role.

### Scenario 4: Identifying empty roles
The admin notices a custom role "Delivery Boy" with 0 users. This helps identify roles that may be candidates for cleanup.

---

## Business Rules
| Code | Rule |
|------|------|
| BR-111 | System roles are: super-admin, admin, cook, manager, client |
| BR-112 | System roles display a "System" badge and cannot be deleted |
| BR-113 | Permission count reflects the total number of permissions assigned to the role |
| BR-114 | User count reflects the total number of users currently holding this role |
| BR-115 | Roles are sorted: system roles first (in hierarchy order), then custom roles alphabetically |

---

## Data Involved
**Reads:**
- Roles (via Spatie): name, guard_name, is_system flag
- Role metadata: name_en, name_fr, description
- Permission count per role (aggregate)
- User count per role (aggregate)

**Creates:**
- Nothing

**Updates:**
- Nothing

**Relationships:**
- F-052: Roles created here appear in this list
- F-054: Clicking a role navigates to edit view
- F-055: Delete action available for custom roles

---

## Acceptance Criteria
- **Given** roles exist, **when** navigating to the role list, **then** all roles are displayed with correct counts
- **Given** the "Custom" filter, **when** selected, **then** only custom roles are shown
- **Given** a role row, **when** clicked, **then** navigation to the role edit page occurs
- **Given** a system role, **when** viewing it in the list, **then** a "System" badge is displayed
- **Given** permission/user counts, **when** displayed, **then** they accurately reflect current data

---

## Verification Steps
1. Navigate to role list — confirm all system and custom roles appear
2. Verify permission counts match actual permission assignments
3. Verify user counts match actual user-role assignments
4. Filter by "Custom" — confirm only custom roles shown
5. Click a role — confirm navigation to edit/detail page

---

## Edge Cases & Exceptions
| Condition | Expected Behavior |
|-----------|-------------------|
| No custom roles exist | Custom filter shows empty state: "No custom roles created yet" |
| Role has 0 permissions | Permission count shows "0" (valid for newly created roles) |
| Role has 0 users | User count shows "0" |
| Spatie guard mismatch | Only roles matching "web" guard are shown (default guard) |

---

## UI/UX Notes
- Table layout with columns: Role Name, Type (System/Custom badge), Permissions, Users, Actions
- Filter tabs above table: All, System, Custom
- System role badge: muted, outline style. Custom role badge: colored, filled
- Permission and user counts as simple numbers, clickable to expand details
- "Create Role" button in top-right corner
- Actions column: Edit (for all), Delete (for custom only, greyed out for system)
- No pagination needed unless many custom roles exist (then paginate at 20)
- Breadcrumb: Admin > Roles

---

## Related Features
| Code | Feature | Relationship |
|------|---------|-------------|
| F-052 | Create Role | Linked via "Create Role" button |
| F-054 | Edit Role | Linked via row click or Edit action |
| F-055 | Delete Role | Delete action for custom roles |
| F-056 | Permission Assignment | Accessible from role edit page |
