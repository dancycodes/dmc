# F-214 â€” Cook Theme Selection

> Module: Cook Settings
> Priority: Must-have
> Precedence: F-076, F-011
> Type: functional

---

## What It Does
Provides the cook-facing UI to select a visual theme for their tenant site. The cook chooses from preset themes (Arctic, High Contrast, Minimal, Modern, Neo Brutalism, and more), a font family (Inter, Roboto, Poppins, Nunito, Open Sans, Montserrat), and a border radius style (none, small, medium, large, full). A live preview shows how the tenant site will look with the selected combination before saving. Changes apply immediately to the tenant domain upon saving. The theme infrastructure is provided by F-011; this feature is the cook's interface to it. All theme changes are logged via Spatie Activitylog.

---

## Who Uses It
| Role | Interaction |
|------|-------------|
| Cook | Selects theme, font, and border radius for their tenant site |
| Client | Experiences the chosen theme when visiting the tenant domain |
| Manager | Cannot change theme (cook-reserved setting) |
| Admin | Can view the tenant's theme selection in admin details |

---

## User Scenarios
### Scenario 1: Cook selects a theme
The cook navigates to Settings > Appearance. They see a grid of theme presets, each represented by a color swatch card with the theme name. The cook clicks "Neo Brutalism." The preview panel updates to show bold colors, thick borders, and the playful Neo Brutalism aesthetic.

### Scenario 2: Cook changes font
The cook selects "Poppins" from the font family dropdown. The preview panel updates to show all text in Poppins. The cook compares it with "Nunito" before deciding.

### Scenario 3: Cook selects border radius
The cook toggles from "medium" (default) to "pill." The preview shows buttons and cards with fully rounded corners. The cook saves all three selections together.

### Scenario 4: Cook saves and verifies
The cook clicks "Save." A success toast confirms: "Theme updated." The cook opens their tenant site in a new tab and sees the Neo Brutalism theme with Poppins font and pill radius applied.

### Scenario 5: Cook resets to default
The cook clicks "Reset to Default." Theme reverts to Modern, font to Inter, radius to medium. The preview updates accordingly.

---

## Business Rules
| Code | Rule |
|------|------|
| BR-520 | Available preset themes: Arctic, High Contrast, Minimal, Modern (default), Neo Brutalism, and additional presets as defined in F-011 |
| BR-521 | Available font families: Inter (default), Roboto, Poppins, Nunito, Open Sans, Montserrat |
| BR-522 | Available border radius options: none (0px), small (4px), medium (8px, default), large (12px), full (16px+) |
| BR-523 | A live preview shows the combined effect of theme + font + radius before saving |
| BR-524 | Changes apply to the tenant domain immediately upon saving |
| BR-525 | Theme settings are stored in the tenant `settings` JSON: `theme`, `font`, `border_radius` |
| BR-526 | Only the cook can change theme settings (cook-reserved action) |
| BR-527 | A "Reset to Default" option restores Modern + Inter + medium |
| BR-528 | The preview must show both light and dark mode variants |
| BR-529 | Theme customization applies to the tenant's public-facing site only, not the dashboard |
| BR-530 | All changes are logged via Spatie Activitylog with old and new values |
| BR-531 | All user-facing text must use `__()` localization |
| BR-532 | Gale handles all preview and save interactions without page reloads |

---

## Data Involved
**Creates:**
- Activity log entry for theme changes

**Reads:**
- Current tenant's theme, font, and border_radius settings
- Theme preset catalog from F-011 infrastructure
- Font catalog
- Border radius options

**Updates:**
- Tenant `settings` JSON column (`theme`, `font`, `border_radius` keys)

**Relationships:**
- Uses the theme infrastructure from F-011
- Applies to F-126 (Tenant Landing Page) and all tenant public pages

---

## Acceptance Criteria
- **Given** the Appearance settings, **when** the cook selects "Arctic," **then** the preview updates to show the Arctic color scheme
- **Given** a font selection, **when** the cook picks "Poppins," **then** the preview text renders in Poppins
- **Given** a radius selection, **when** the cook picks "pill," **then** the preview shows fully rounded elements
- **Given** the cook clicks save, **when** visiting the tenant domain, **then** the selected theme/font/radius are applied
- **Given** a new tenant with no customization, **when** viewing appearance settings, **then** defaults are Modern + Inter + medium
- **Given** the cook clicks "Reset to Default," **when** saved, **then** the tenant reverts to default appearance
- **Given** the preview panel, **when** toggling dark mode preview, **then** the dark variant of the selected theme is shown

---

## Verification Steps
1. Navigate to Settings > Appearance -- confirm theme grid, font selector, and radius options are displayed
2. Select "Neo Brutalism" -- confirm preview updates with bold aesthetic
3. Select "Poppins" font -- confirm preview text changes
4. Select "pill" radius -- confirm preview elements are fully rounded
5. Save and visit the tenant domain -- confirm all three selections are applied
6. Toggle dark mode in the preview -- confirm dark variant
7. Click "Reset to Default" and save -- confirm Modern + Inter + medium
8. Check activity log for theme change entry with before/after values
9. Verify managers cannot access the Appearance settings

---

## Edge Cases & Exceptions
| Condition | Expected Behavior |
|-----------|-------------------|
| Theme preset removed from catalog | Tenant retains the saved name; falls back to Modern on next page load |
| Google Fonts CDN unavailable | Fallback to system sans-serif; no broken layout |
| Cook saves without changing anything | No activity log entry; no unnecessary write |
| Preview on very slow connection | Loading indicator on preview panel; theme swatches load instantly (local) |
| Cook switches between themes rapidly | Only the final save persists; preview is debounced |
| Tenant domain visited mid-save | Race condition: visitor sees either old or new theme; no broken state |

---

## UI/UX Notes
- Located in Cook Dashboard > Settings > Appearance tab/section
- Theme selection: visual grid of color swatch cards (4-6 color circles per card), theme name below
- Selected theme has a visible checkmark and border highlight
- Font selection: dropdown with font name rendered in its own font for visual preview
- Border radius: segmented control (none | small | medium | large | full) with visual icons
- Preview panel: a miniature rendering of a landing page section (hero + card + button) with the selected theme/font/radius applied
- Preview has a light/dark toggle to preview both modes
- "Save" button at the bottom; "Reset to Default" as a secondary text button
- Mobile: stacked layout; theme grid 2 columns; preview below the selectors
- The preview updates via Gale as selections change (no save needed for preview)

---

## Related Features
| Code | Feature | Relationship |
|------|---------|-------------|
| F-011 | Tenant Theme Customization Infrastructure | Provides the CSS variable system and theme catalog |
| F-076 | Cook Dashboard Layout & Navigation | Dashboard where settings live |
| F-126 | Tenant Landing Page Layout | Renders with the selected theme |
| F-009 | Theme System (Light/Dark Mode) | Base light/dark mode system |
