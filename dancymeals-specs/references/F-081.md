# F-081 â€” Cook Cover Images Management

> Module: Cook Profile
> Priority: Must-have
> Precedence: F-079
> Type: functional

---

## What It Does

Full cover images management page within the cook dashboard. Allows uploading new images (up to 5 total), reordering via drag-and-drop, deleting individual images, and previewing the carousel. Uses the same upload constraints as the onboarding wizard (JPG/PNG/WebP, 2MB max per image). Changes reflect immediately on the cook's tenant landing page and discovery card.

---

## Who Uses It

| Role | Interaction |
|------|-------------|
| Cook | Manages their cover images: upload, reorder, delete, preview |
| Manager | Manages cover images if granted profile edit permission |

---

## User Scenarios

### Scenario 1: Upload a new image
A cook with 3 existing images clicks "Upload Image," selects a JPG from their device. The image uploads with a progress bar, is resized/cropped, and appears as the 4th thumbnail. The preview carousel updates to include the new image.

### Scenario 2: Reorder images
A cook drags the 3rd image to the 1st position. The thumbnails reorder. The preview carousel now starts with the newly first image. The order change is saved automatically.

### Scenario 3: Delete an image
A cook clicks the delete button on one of their 5 images. A confirmation dialog appears: "Delete this image?" After confirming, the image is removed. The remaining 4 images reorder and the carousel updates.

### Scenario 4: Upload at maximum
A cook with 5 images tries to upload another. The upload button is disabled with a tooltip: "Maximum 5 images. Delete one to upload a new one."

### Scenario 5: Replace an image
A cook wants to replace their 2nd image. They delete the 2nd image (now 4 remain), then upload a new image which becomes the 5th. They drag it to the 2nd position.

---

## Business Rules

| Code | Rule |
|------|------|
| BR-197 | Maximum 5 cover images per cook |
| BR-198 | Accepted formats: JPEG, PNG, WebP |
| BR-199 | Maximum file size: 2MB per image |
| BR-200 | Images resized to consistent aspect ratio (16:9) |
| BR-201 | First image in order is the primary/featured image (shown on discovery card) |
| BR-202 | Drag-to-reorder saves automatically via Gale |
| BR-203 | Deleting an image requires confirmation dialog |
| BR-204 | Upload button disabled when 5 images exist |
| BR-205 | Changes reflect immediately on the tenant landing page and discovery card |
| BR-206 | Both mouse drag (desktop) and touch drag (mobile) must work for reordering |

---

## Data Involved

**Creates:**
- New image records and files on upload

**Reads:**
- Existing cover images (ordered list)

**Updates:**
- Image order/position on reorder
- Image records and files on delete

---

## Acceptance Criteria

- **Given** fewer than 5 images, **when** the cook uploads a valid image, **then** it appears in the thumbnail grid and preview carousel
- **Given** 5 images, **when** the upload button is checked, **then** it is disabled with a maximum message
- **Given** multiple images, **when** the cook drags one to a new position, **then** the order saves automatically
- **Given** an image, **when** the cook clicks delete and confirms, **then** the image is removed and remaining images reorder
- **Given** an oversized file (>2MB), **when** uploaded, **then** a size error is shown
- **Given** a non-image file, **when** uploaded, **then** a format error is shown
- **Given** a reorder, **when** visiting the tenant landing page, **then** the carousel reflects the new order

---

## Verification Steps

1. Upload valid images in each format (JPG, PNG, WebP) and confirm acceptance
2. Upload a file over 2MB and confirm rejection
3. Upload 5 images and verify the upload button is disabled
4. Drag to reorder and confirm the carousel preview updates
5. Delete an image and confirm removal with remaining images intact
6. Visit the tenant landing page and confirm carousel matches dashboard order
7. Test drag-to-reorder on mobile (touch drag)

---

## Edge Cases & Exceptions

| Condition | Expected Behavior |
|-----------|-------------------|
| Upload interrupted by network failure | Partial upload cleaned up; error message shown with retry option |
| All images deleted | No carousel shown; placeholder appears on profile and landing page |
| Rapid successive reorder actions | Each reorder debounced; final order saved |
| Image stored on disk but record deleted (orphan) | Background cleanup handles orphan files |
| Browser does not support drag-and-drop API | Fallback: up/down arrow buttons for reordering |

---

## UI/UX Notes

- Full-width page (not constrained by wizard step width)
- Thumbnail grid: 3 columns desktop, 2 columns tablet, 2 columns mobile
- Each thumbnail: image preview, delete button (X) in top-right corner, drag handle on left
- Upload area: dashed-border drop zone or button above the grid
- Counter: "3/5 images" displayed
- Preview carousel below the grid, full-width, matching public display style
- Breadcrumb: Dashboard > Profile > Cover Images
- Loading overlay on thumbnails during upload/reorder operations

---

## Related Features

| Code | Feature | Relationship |
|------|---------|-------------|
| F-079 | Cook Brand Profile View | Links to this management page from the profile view |
| F-073 | Cover Images Step | Wizard version of this feature |
| F-067 | Cook Card Component | Discovery card displays these images |
| F-126 | Tenant Landing Page Layout | Landing page displays these images in carousel |
