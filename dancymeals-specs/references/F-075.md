# F-075 — Schedule & First Meal Step

> Module: Cook Onboarding
> Priority: Must-have
> Precedence: F-071
> Type: functional

---

## What It Does

Wizard Step 4. Allows the cook to set their availability schedule for at least one day of the week and create their first meal with at least one component. This is a simplified version of the full schedule and meal management features. After completion, the "Go Live" button becomes available (assuming Steps 1 and 3 are also complete). This step combines two related setup actions to minimize wizard steps.

---

## Who Uses It

| Role | Interaction |
|------|-------------|
| Cook | Sets availability hours and creates their first meal listing |
| Manager | May set up schedule and meals if permitted |

---

## User Scenarios

### Scenario 1: Set schedule and create first meal
A cook selects Monday, sets availability from 11:00 to 20:00. Then creates a meal: name "Ndole & Plantain" (en/fr), price 2500 XAF, adds one component "Ndole with spinach and peanuts." They click "Complete" and the wizard shows the "Go Live" button as enabled.

### Scenario 2: Multiple availability days
A cook sets availability for Monday-Friday from 10:00 to 21:00, and Saturday from 12:00 to 18:00. Sunday is left unchecked (unavailable).

### Scenario 3: Minimal meal creation
A cook creates a meal with just the required fields: name (en/fr), price, and one component name. No description or image. The meal is saved as active.

### Scenario 4: Incomplete step
A cook sets a schedule but does not create a meal. The "Go Live" button remains disabled. A message explains: "Create at least one meal to go live."

### Scenario 5: Skip schedule
A cook does not set any schedule days and only creates a meal. The wizard warns that without a schedule, clients cannot determine availability, but does not block "Go Live" if the other minimum requirements (brand info + delivery area + meal) are met.

---

## Business Rules

| Code | Rule |
|------|------|
| BR-146 | Schedule sets availability per day of the week with start and end times |
| BR-147 | At least one meal with at least one component is required for minimum setup |
| BR-148 | Meal name is required in both English and French |
| BR-149 | Meal price must be > 0 XAF |
| BR-150 | Each meal must have at least one component (component name required in en/fr) |
| BR-151 | Created meals default to `is_active = true` |
| BR-152 | Schedule times use 24-hour format |
| BR-153 | End time must be after start time for each scheduled day |
| BR-154 | Schedule and meal data use the same models/tables as the full features |
| BR-155 | This step is considered complete when at least one active meal with one component exists |

---

## Data Involved

**Creates:**
- Schedule records: tenant_id, day_of_week, start_time, end_time, is_available
- Meal records: tenant_id, name_en, name_fr, description_en, description_fr, price, is_active
- Meal component records: meal_id, name_en, name_fr, description_en, description_fr

**Reads:**
- Existing schedule and meals (for pre-population on revisit)

**Updates:**
- Nothing (only creates during onboarding; editing is done in dashboard)

---

## Acceptance Criteria

- **Given** Step 4 of the wizard, **when** the cook sets a schedule for Monday and creates a meal with one component, **then** both are saved and the step is marked complete
- **Given** no meals created, **when** the cook tries to finish the step, **then** a message states at least one meal is required
- **Given** a meal with price 0, **when** submitting, **then** a validation error requires price > 0
- **Given** a meal name in English only, **when** submitting, **then** a validation error requires the French name
- **Given** a schedule with end time before start time, **when** submitting, **then** a validation error is shown
- **Given** all minimum requirements met (steps 1, 3, 4 complete), **when** viewing the wizard, **then** the "Go Live" button is enabled

---

## Verification Steps

1. Set availability for one day and confirm it saves
2. Create a meal with name (en/fr), price, and one component — confirm it saves
3. Verify the "Go Live" button is enabled after completing this step (with steps 1 and 3 also complete)
4. Attempt to create a meal without a component — confirm validation error
5. Attempt to set end time before start time — confirm validation error
6. Return to this step and confirm previously saved data is displayed
7. Create a meal with price 0 — confirm validation rejection

---

## Edge Cases & Exceptions

| Condition | Expected Behavior |
|-----------|-------------------|
| Cook sets same day twice (e.g., two Monday entries) | Only one schedule entry per day; second overwrites first |
| Cook sets schedule for all 7 days | All saved; no limit on schedule days |
| Very high meal price (e.g., 1,000,000 XAF) | Accepted but soft warning for unusually high price |
| Meal component with empty description | Allowed; only component name is required |
| Cook leaves schedule empty but creates a meal | Step considered complete (meal exists); schedule warning shown |

---

## UI/UX Notes

- Two sections: "Your Schedule" (top) and "Your First Meal" (bottom)
- Schedule: 7 day toggles with time pickers for start/end when enabled
- Day labels: Mon, Tue, Wed, Thu, Fri, Sat, Sun with toggle switches
- Time pickers use 24-hour format with 30-minute increments
- Meal creation: simple form with name (en/fr), optional description (en/fr), price field with XAF
- Component addition: inline "Add component" with name (en/fr) field
- "Complete" button replaces "Save & Continue" on the final step
- The "Go Live" button appears below with clear enabled/disabled state
- Mobile: sections stack vertically with clear separation

---

## Related Features

| Code | Feature | Relationship |
|------|---------|-------------|
| F-071 | Cook Setup Wizard Shell | Parent wizard; "Go Live" logic lives here |
| F-074 | Delivery Areas Step | Previous step in the wizard |
| F-076 | Cook Dashboard Layout | Destination after "Go Live" |
