# F-057 — Platform Analytics Dashboard

> Module: Admin
> Priority: Should-have
> Precedence: F-043
> Type: functional

---

## What It Does
Provides a comprehensive analytics dashboard within the admin panel showing platform-wide metrics: total revenue (with platform commission), total orders, active tenants, active users, new registrations, and popular cooks/meals. Includes a time period selector (today, this week, this month, this year, custom range) and charts for revenue and order trends over time.

---

## Who Uses It
| Role | Interaction |
|------|-------------|
| Super-Admin | Views full platform analytics |
| Admin | Views platform analytics (same access as super-admin for analytics) |

---

## User Scenarios
### Scenario 1: Viewing today's snapshot
An admin opens the Analytics Dashboard. The default view shows today's data: total revenue (XAF 45,000), platform commission earned (XAF 4,500), total orders (12), active tenants (8), active users (34). Summary cards are displayed at the top.

### Scenario 2: Switching to monthly view
The admin selects "This Month" from the time period selector. All metrics update to reflect the current month. The revenue chart shows a daily breakdown for the month. The order chart shows daily order volume.

### Scenario 3: Custom date range
The admin selects "Custom" and picks January 1 to January 31. All metrics recalculate for that period. Charts display the selected range.

### Scenario 4: Viewing popular cooks
The admin scrolls to the "Top Cooks" section. A ranked list shows the top 10 cooks by revenue for the selected period: cook name, tenant name, total orders, total revenue. The first cook has XAF 320,000 in revenue from 85 orders.

### Scenario 5: Viewing popular meals
The admin sees a "Top Meals" section listing the 10 most-ordered meals across the platform for the selected period: meal name, cook/tenant, times ordered, total revenue.

---

## Business Rules
| Code | Rule |
|------|------|
| BR-135 | Revenue figures include only completed/delivered orders |
| BR-136 | Commission earned = sum of platform's commission portion from all completed orders |
| BR-137 | Active tenants = tenants with status "active" |
| BR-138 | Active users = users who logged in during the selected period |
| BR-139 | New registrations = users created during the selected period |
| BR-140 | Time periods: Today, This Week, This Month, This Year, Custom Range |
| BR-141 | Custom range maximum span is 1 year |
| BR-142 | Top cooks and meals are ranked by revenue in the selected period |

---

## Data Involved
**Reads:**
- Orders: amounts, statuses, timestamps, tenant associations
- Commission records: platform commission per order
- Tenants: status, count
- Users: created_at, last_login_at
- Meals: order counts, revenue per meal

**Creates:**
- Nothing (read-only dashboard)

**Updates:**
- Nothing

**Relationships:**
- F-043: Displayed within admin panel layout
- F-058: Detailed financial reports extend this overview

---

## Acceptance Criteria
- **Given** the analytics dashboard, **when** loaded with default "Today" period, **then** all metric cards show today's data
- **Given** a time period change to "This Month", **when** selected, **then** all metrics and charts update without page reload
- **Given** a custom date range, **when** applied, **then** metrics reflect that exact period
- **Given** completed orders exist, **when** viewing revenue, **then** it matches the sum of completed order amounts
- **Given** multiple cooks with orders, **when** viewing Top Cooks, **then** they are ranked by revenue descending

---

## Verification Steps
1. Load dashboard — confirm summary cards show accurate data for today
2. Switch to "This Month" — confirm metrics update without page reload
3. Select a custom date range — confirm metrics reflect the chosen period
4. Cross-reference revenue total with database aggregates — confirm accuracy
5. Verify Top Cooks ranking matches actual revenue order
6. Verify Top Meals ranking matches actual order counts

---

## Edge Cases & Exceptions
| Condition | Expected Behavior |
|-----------|-------------------|
| No orders in selected period | Revenue and order cards show 0; charts show flat line at 0 |
| No new registrations | New registrations card shows 0 |
| Custom range with start > end date | Validation error: "Start date must be before end date" |
| Very large dataset (100,000+ orders) | Data aggregated server-side; charts show summarized points |
| Period with no active tenants | Active tenants card shows 0 |

---

## UI/UX Notes
- Summary cards in a responsive grid at the top: Revenue, Commission, Orders, Active Tenants, Active Users, New Users
- Each card shows the metric value and a percentage change vs. the previous equivalent period (e.g., +12% vs last month)
- Time period selector: segmented control for presets, with a date picker for custom range
- Revenue chart: line or area chart, daily granularity for periods up to 3 months, weekly for longer
- Order chart: bar chart showing daily/weekly order volume
- Top Cooks: numbered list with cook avatar, name, revenue, order count
- Top Meals: numbered list with meal image thumbnail, name, order count, revenue
- All charts and lists update when the time period changes (via Gale)
- Mobile: cards stack vertically, charts are full-width and scrollable

---

## Related Features
| Code | Feature | Relationship |
|------|---------|-------------|
| F-043 | Admin Panel Layout | Parent layout |
| F-058 | Financial Reports | Detailed financial analysis extends this overview |
| F-062 | Commission Configuration | Commission rates affect revenue calculations |
