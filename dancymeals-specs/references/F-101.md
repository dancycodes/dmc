# F-101 — Create Schedule Template

> Module: Schedule
> Priority: Must-have
> Precedence: F-098
> Type: functional

---

## What It Does
Allows a cook to create a reusable schedule template with pre-configured time intervals for order, delivery, and pickup. Templates save the cook time by bundling a complete set of time intervals that can be applied to multiple days at once (via F-105). A template includes a name, order interval configuration, delivery interval configuration, and pickup interval configuration. Templates are tenant-scoped and managed via Gale.

---

## Who Uses It
| Role | Interaction |
|------|-------------|
| Cook | Creates schedule templates for reuse across multiple days |
| Manager | Creates templates if granted `manage-schedules` permission |

---

## User Scenarios
### Scenario 1: Create a lunch template
The cook creates a template named "Lunch Service" with: order interval from 6:00 PM day before to 9:00 AM same day, delivery from 11:30 AM to 2:00 PM, pickup from 11:00 AM to 2:30 PM. The template is saved and appears in the template list.

### Scenario 2: Create a dinner template
The cook creates a "Dinner Service" template with: order interval from 8:00 AM to 4:00 PM same day, delivery from 6:00 PM to 9:00 PM, pickup from 5:30 PM to 9:30 PM.

### Scenario 3: Template with delivery only
The cook creates a "Delivery Only Lunch" template with delivery enabled and pickup disabled.

### Scenario 4: Invalid template — missing order interval
The cook tries to save a template without configuring the order interval. Validation fails since the order interval is required.

### Scenario 5: Duplicate template name
The cook tries to create a template with a name already used by another template in the same tenant. Validation rejects the duplicate name.

---

## Business Rules
| Code | Rule |
|------|------|
| BR-127 | Each template must have a unique name within the tenant |
| BR-128 | Template name is required, max 100 characters |
| BR-129 | Order interval is required in every template |
| BR-130 | Delivery and/or pickup intervals are required — at least one must be enabled |
| BR-131 | All time interval validations from F-099 and F-100 apply to template intervals |
| BR-132 | Templates are tenant-scoped |
| BR-133 | Only users with `manage-schedules` permission can create templates |
| BR-134 | Template creation is logged via Spatie Activitylog |
| BR-135 | Templates are independent entities — they are copied to schedules when applied, not linked |

---

## Data Involved
**Creates:**
- `ScheduleTemplate` model with fields: `id`, `tenant_id`, `name`, `order_start_time`, `order_start_day_offset`, `order_end_time`, `order_end_day_offset`, `delivery_enabled`, `delivery_start_time`, `delivery_end_time`, `pickup_enabled`, `pickup_start_time`, `pickup_end_time`, `created_at`, `updated_at`
- Migration for `schedule_templates` table
- Factory and seeder for ScheduleTemplate

**Reads:**
- Existing templates for name uniqueness validation
- Tenant context

**Updates:**
- Nothing (creation only)

**Relationships:**
- ScheduleTemplate belongsTo Tenant
- ScheduleTemplate is copied to CookSchedule entries when applied (F-105)

---

## Acceptance Criteria
- **Given** a cook on the template creation form, **when** they fill in a valid name and all intervals, **then** the template is saved and appears in the list
- **Given** no order interval configured, **when** the cook tries to save, **then** validation fails
- **Given** a duplicate template name, **when** submitted, **then** validation fails with a clear error
- **Given** both delivery and pickup disabled, **when** submitted, **then** validation fails
- **Given** a manager with `manage-schedules` permission, **when** they create a template, **then** it saves successfully

---

## Verification Steps
1. Create a template with all fields filled — confirm it saves and appears in the list
2. Attempt to save without an order interval — confirm validation error
3. Attempt to save with a duplicate name — confirm validation error
4. Create a template with only delivery — confirm pickup shows as disabled
5. Create a template with only pickup — confirm delivery shows as disabled
6. Attempt to save with both delivery and pickup disabled — confirm validation error
7. Check activity log for template creation entry

---

## Edge Cases & Exceptions
| Condition | Expected Behavior |
|-----------|-------------------|
| Template name with leading/trailing spaces | Trimmed before saving and uniqueness check |
| Very long template name (over 100 chars) | Validation error with max length message |
| Cook has no templates yet | Template list shows empty state with prompt to create first template |
| Template intervals violate time rules | Same validation as F-099 and F-100 applies |

---

## UI/UX Notes
- Accessible from Schedule section via "Templates" tab or link
- Form layout: template name field at top, then order interval section, then delivery section, then pickup section
- Same time picker UI as schedule entry configuration (F-099, F-100)
- Preview summary at the bottom showing all configured intervals in human-readable format
- Save and Cancel buttons
- Mobile-friendly stacked form
- All interactions via Gale

---

## Related Features
| Code | Feature | Relationship |
|------|---------|-------------|
| F-098 | Cook Day Schedule Creation | Templates contain the same interval types as schedule entries |
| F-099 | Order Time Interval Configuration | Template order interval follows same rules |
| F-100 | Delivery/Pickup Time Interval Config | Template delivery/pickup follows same rules |
| F-102 | Schedule Template List View | Lists templates created here |
| F-105 | Schedule Template Application to Days | Applies templates to schedule entries |
