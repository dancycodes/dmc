# F-050 — User Management List & Search

> Module: Admin
> Priority: Must-have
> Precedence: F-043
> Type: functional

---

## What It Does
Displays a paginated, searchable, filterable list of all platform users in the admin panel. Shows key user information including name, email, phone, roles, account status, registration date, and last login time. Supports searching by name, email, or phone, filtering by role and status, and sorting by any column.

---

## Who Uses It
| Role | Interaction |
|------|-------------|
| Super-Admin | Views and manages all platform users |
| Admin | Views and manages all platform users |

---

## User Scenarios
### Scenario 1: Browsing all users
An admin navigates to Users in the sidebar. A paginated table loads with columns: name, email, phone, roles (as badges), status (Active/Inactive), registration date, and last login. Default sort is by registration date (newest first), 20 users per page.

### Scenario 2: Searching for a user
The admin types "amara@" in the search bar. The table filters to show users whose name, email, or phone contain the search term. Results update with debounced search.

### Scenario 3: Filtering by role
The admin selects "Cook" from the role filter dropdown. Only users who have the cook role (on any tenant) are displayed.

### Scenario 4: Filtering by status
The admin selects "Inactive" from the status filter. Only deactivated users are shown.

### Scenario 5: Combined filters
The admin searches for "douala", filters by role "Client", and sorts by "Last Login" ascending. Only clients from Douala-related entries who have not logged in recently appear first.

---

## Business Rules
| Code | Rule |
|------|------|
| BR-089 | User list shows ALL platform users regardless of tenant |
| BR-090 | Pagination defaults to 20 items per page |
| BR-091 | Search covers: name, email, phone number |
| BR-092 | Role filter shows all system roles: super-admin, admin, cook, manager, client |
| BR-093 | Status filter options: All, Active, Inactive |
| BR-094 | Default sort: registration date descending (newest first) |
| BR-095 | Last login shows relative time ("2 hours ago", "3 days ago") |
| BR-096 | Users with multiple roles show all roles as separate badges |

---

## Data Involved
**Reads:**
- Users table: name, email, phone, is_active, created_at, last_login_at
- User roles (via Spatie): role names for each user
- User count aggregates for summary cards

**Creates:**
- Nothing

**Updates:**
- Nothing

**Relationships:**
- F-051: Clicking a row navigates to user detail page
- F-006: Roles retrieved via Spatie Permission

---

## Acceptance Criteria
- **Given** users exist, **when** navigating to the user list, **then** a paginated table is displayed with correct columns
- **Given** a search term, **when** typed, **then** results filter to matching users
- **Given** the role filter set to "Cook", **when** applied, **then** only users with the cook role are shown
- **Given** combined search and filters, **when** applied together, **then** results reflect all criteria
- **Given** a user row, **when** clicked, **then** navigation to the user detail page occurs

---

## Verification Steps
1. Navigate to user list with 25+ users — confirm pagination
2. Search by email fragment — confirm correct filtering
3. Filter by "Cook" role — confirm only cooks shown
4. Sort by "Last Login" — confirm order changes
5. Click a user row — confirm navigation to detail page

---

## Edge Cases & Exceptions
| Condition | Expected Behavior |
|-----------|-------------------|
| No users match search/filter | Empty state: "No users match your criteria" with clear filters option |
| User has no roles assigned | Roles column shows "No role" in muted text |
| User has never logged in | Last login shows "Never" |
| Phone number with different formats (+237, 237, no prefix) | Search normalizes and matches |
| Very large user base (10,000+) | Search is debounced; pagination handles load |

---

## UI/UX Notes
- Summary cards above table: Total Users, Active, Inactive, New This Month
- Search bar with icon, role dropdown filter, status dropdown filter — all on one row
- Role badges color-coded: super-admin (red), admin (orange), cook (blue), manager (purple), client (green)
- Status shown as a colored dot: green (active), gray (inactive)
- Mobile: table converts to card layout with essential fields
- "Last Login" uses relative time with tooltip showing exact datetime
- No "Create User" button — users self-register; admins manage existing accounts

---

## Related Features
| Code | Feature | Relationship |
|------|---------|-------------|
| F-043 | Admin Panel Layout | Parent layout |
| F-051 | User Detail View | Navigated to from row click |
| F-006 | Spatie Permission Setup | Provides role data for filtering and display |
